<div class="card" style="max-width: 600px; margin: 50px auto;">
    <h2 style="text-align: center; color: #2c3e50; margin-bottom: 30px;">
        Оценка качества работ
    </h2>
    
    <% if (request) { %>
    
    <% if (typeof success !== 'undefined' && success) { %>
        <div class="alert alert-success">
            <h3>Спасибо за вашу оценку!</h3>
            <p>Ваш отзыв поможет нам улучшить качество обслуживания.</p>
            <a href="/" class="btn btn-primary" style="margin-top: 15px;">
                Вернуться на главную
            </a>
        </div>
    <% } else { %>
        <form method="POST" action="/quality-rating/<%= request.request_id %>">
            <div class="form-group" style="margin-top: 30px;">
                <label for="comment" style="font-size: 16px; font-weight: 600;">
                    Дополнительные комментарии (необязательно):
                </label>
                <textarea 
                    id="comment" 
                    name="comment" 
                    rows="4" 
                    placeholder="Расскажите подробнее о качестве выполненных работ..."
                    style="width: 100%; padding: 12px; border: 2px solid #dee2e6; border-radius: 4px; font-family: inherit; resize: vertical; margin-top: 10px;"
                ></textarea>
            </div>
            
            <div class="form-group">
                <label style="font-size: 16px; font-weight: 600; margin-bottom: 15px;">
                    Как вы оцениваете качество выполненных работ?
                </label>
                
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <label style="display: flex; align-items: center; padding: 15px; border: 2px solid #dee2e6; border-radius: 4px; cursor: pointer; transition: all 0.2s;">
                        <input type="radio" name="rating" value="Плохо" required style="margin-right: 15px; transform: scale(1.2);">
                        <div>
                            <strong style="color: #e74c3c; font-size: 18px;">Плохо</strong>
                            <p style="margin: 5px 0 0 0; color: #6c757d; font-size: 14px;">
                                Работа выполнена некачественно, есть серьезные замечания
                            </p>
                        </div>
                    </label>
                    
                    <label style="display: flex; align-items: center; padding: 15px; border: 2px solid #dee2e6; border-radius: 4px; cursor: pointer; transition: all 0.2s;">
                        <input type="radio" name="rating" value="Нормально" required style="margin-right: 15px; transform: scale(1.2);">
                        <div>
                            <strong style="color: #f39c12; font-size: 18px;">Нормально</strong>
                            <p style="margin: 5px 0 0 0; color: #6c757d; font-size: 14px;">
                                Работа выполнена удовлетворительно, есть небольшие замечания
                            </p>
                        </div>
                    </label>
                    
                    <label style="display: flex; align-items: center; padding: 15px; border: 2px solid #dee2e6; border-radius: 4px; cursor: pointer; transition: all 0.2s;">
                        <input type="radio" name="rating" value="Хорошо" required style="margin-right: 15px; transform: scale(1.2);">
                        <div>
                            <strong style="color: #27ae60; font-size: 18px;">Хорошо</strong>
                            <p style="margin: 5px 0 0 0; color: #6c757d; font-size: 14px;">
                                Работа выполнена качественно, в срок, без замечаний
                            </p>
                        </div>
                    </label>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button type="submit" class="btn btn-primary" style="padding: 15px 40px; font-size: 16px;">
                    Отправить оценку
                </button>
            </div>
        </form>
    <% } %>
    
    <div style="background: #f8f9fa; padding: 20px; border-radius: 4px; margin-bottom: 30px;">
        <h3 style="margin-bottom: 15px;">Информация о заявке</h3>
        <p><strong>Дата завершения:</strong> <%= request.completion_date ? new Date(request.completion_date).toLocaleDateString('ru-RU') : 'Не указана' %></p>
        <p><strong>Специалист:</strong> <%= request.master_name || 'Не назначен' %></p>
        <p><strong>Модель:</strong> <%= request.model_name %></p>
        <p><strong>Тип оборудования:</strong> <%= request.type_name %></p>
        <p><strong>Номер заявки:</strong> <%= request.request_number %></p>
    </div>
    
    <% } else { %>
        <div class="alert alert-danger">
            <h3>Заявка не найдена</h3>
            <p>Указанная заявка не существует или недоступна для оценки.</p>
            <a href="/" class="btn btn-primary">
                Вернуться на главную
            </a>
        </div>
    <% } %>
</div>

<style>
input[type="radio"]:checked + div strong {
    color: #2c3e50 !important;
}

label:has(input[type="radio"]:checked) {
    border-color: #2c3e50 !important;
    background-color: rgba(44, 62, 80, 0.05) !important;
}

label:hover {
    border-color: #495057 !important;
    background-color: rgba(73, 80, 87, 0.05) !important;
}
</style>