<?xml version="1.0" encoding="UTF-8"?>
<svg width="1400" height="1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .entity { fill: #e1f5fe; stroke: #0277bd; stroke-width: 2; }
      .entity-title { fill: #01579b; font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; }
      .attribute { fill: #333; font-family: Arial, sans-serif; font-size: 11px; }
      .pk { fill: #d32f2f; font-weight: bold; }
      .fk { fill: #1976d2; font-style: italic; }
      .relationship { stroke: #424242; stroke-width: 2; fill: none; }
      .cardinality { fill: #666; font-family: Arial, sans-serif; font-size: 10px; }
    </style>
  </defs>
  
  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" class="entity-title" font-size="18">
    ER-диаграмма системы управления заявками на ремонт климатического оборудования
  </text>
  
  <!-- Users Entity -->
  <g id="users">
    <rect x="50" y="80" width="200" height="160" class="entity"/>
    <text x="150" y="100" text-anchor="middle" class="entity-title">users</text>
    <line x1="50" y1="110" x2="250" y2="110" stroke="#0277bd" stroke-width="1"/>
    <text x="60" y="125" class="attribute pk">user_id (PK)</text>
    <text x="60" y="140" class="attribute">full_name</text>
    <text x="60" y="155" class="attribute">phone</text>
    <text x="60" y="170" class="attribute">login (UK)</text>
    <text x="60" y="185" class="attribute">password_hash</text>
    <text x="60" y="200" class="attribute">user_type</text>
    <text x="60" y="215" class="attribute">is_active</text>
    <text x="60" y="230" class="attribute">created_at</text>
  </g>
  
  <!-- Equipment Types Entity -->
  <g id="equipment_types">
    <rect x="350" y="80" width="200" height="120" class="entity"/>
    <text x="450" y="100" text-anchor="middle" class="entity-title">equipment_types</text>
    <line x1="350" y1="110" x2="550" y2="110" stroke="#0277bd" stroke-width="1"/>
    <text x="360" y="125" class="attribute pk">type_id (PK)</text>
    <text x="360" y="140" class="attribute">type_name (UK)</text>
    <text x="360" y="155" class="attribute">description</text>
    <text x="360" y="170" class="attribute">created_at</text>
  </g>
  
  <!-- Equipment Models Entity -->
  <g id="equipment_models">
    <rect x="650" y="80" width="200" height="140" class="entity"/>
    <text x="750" y="100" text-anchor="middle" class="entity-title">equipment_models</text>
    <line x1="650" y1="110" x2="850" y2="110" stroke="#0277bd" stroke-width="1"/>
    <text x="660" y="125" class="attribute pk">model_id (PK)</text>
    <text x="660" y="140" class="attribute">model_name</text>
    <text x="660" y="155" class="attribute fk">type_id (FK)</text>
    <text x="660" y="170" class="attribute">manufacturer</text>
    <text x="660" y="185" class="attribute">description</text>
    <text x="660" y="200" class="attribute">created_at</text>
  </g>
  
  <!-- Request Statuses Entity -->
  <g id="request_statuses">
    <rect x="950" y="80" width="200" height="120" class="entity"/>
    <text x="1050" y="100" text-anchor="middle" class="entity-title">request_statuses</text>
    <line x1="950" y1="110" x2="1150" y2="110" stroke="#0277bd" stroke-width="1"/>
    <text x="960" y="125" class="attribute pk">status_id (PK)</text>
    <text x="960" y="140" class="attribute">status_name (UK)</text>
    <text x="960" y="155" class="attribute">status_description</text>
    <text x="960" y="170" class="attribute">status_color</text>
  </g>
  
  <!-- Repair Requests Entity (Central) -->
  <g id="repair_requests">
    <rect x="450" y="300" width="250" height="280" class="entity"/>
    <text x="575" y="320" text-anchor="middle" class="entity-title">repair_requests</text>
    <line x1="450" y1="330" x2="700" y2="330" stroke="#0277bd" stroke-width="1"/>
    <text x="460" y="345" class="attribute pk">request_id (PK)</text>
    <text x="460" y="360" class="attribute">request_number (UK)</text>
    <text x="460" y="375" class="attribute">start_date</text>
    <text x="460" y="390" class="attribute">completion_date</text>
    <text x="460" y="405" class="attribute">problem_description</text>
    <text x="460" y="420" class="attribute">repair_parts</text>
    <text x="460" y="435" class="attribute">priority_level</text>
    <text x="460" y="450" class="attribute">estimated_completion_date</text>
    <text x="460" y="465" class="attribute">actual_completion_date</text>
    <text x="460" y="480" class="attribute fk">client_id (FK)</text>
    <text x="460" y="495" class="attribute fk">master_id (FK)</text>
    <text x="460" y="510" class="attribute fk">status_id (FK)</text>
    <text x="460" y="525" class="attribute fk">type_id (FK)</text>
    <text x="460" y="540" class="attribute fk">model_id (FK)</text>
    <text x="460" y="555" class="attribute">created_at</text>
    <text x="460" y="570" class="attribute">updated_at</text>
  </g>
  
  <!-- Request Comments Entity -->
  <g id="request_comments">
    <rect x="50" y="650" width="200" height="140" class="entity"/>
    <text x="150" y="670" text-anchor="middle" class="entity-title">request_comments</text>
    <line x1="50" y1="680" x2="250" y2="680" stroke="#0277bd" stroke-width="1"/>
    <text x="60" y="695" class="attribute pk">comment_id (PK)</text>
    <text x="60" y="710" class="attribute">message</text>
    <text x="60" y="725" class="attribute">created_at</text>
    <text x="60" y="740" class="attribute fk">request_id (FK)</text>
    <text x="60" y="755" class="attribute fk">user_id (FK)</text>
  </g>
  
  <!-- Quality Ratings Entity -->
  <g id="quality_ratings">
    <rect x="350" y="650" width="200" height="140" class="entity"/>
    <text x="450" y="670" text-anchor="middle" class="entity-title">quality_ratings</text>
    <line x1="350" y1="680" x2="550" y2="680" stroke="#0277bd" stroke-width="1"/>
    <text x="360" y="695" class="attribute pk">rating_id (PK)</text>
    <text x="360" y="710" class="attribute fk">request_id (FK)</text>
    <text x="360" y="725" class="attribute">rating</text>
    <text x="360" y="740" class="attribute">comment</text>
    <text x="360" y="755" class="attribute">created_at</text>
  </g>
  
  <!-- Request History Entity -->
  <g id="request_history">
    <rect x="650" y="650" width="200" height="160" class="entity"/>
    <text x="750" y="670" text-anchor="middle" class="entity-title">request_history</text>
    <line x1="650" y1="680" x2="850" y2="680" stroke="#0277bd" stroke-width="1"/>
    <text x="660" y="695" class="attribute pk">history_id (PK)</text>
    <text x="660" y="710" class="attribute fk">request_id (FK)</text>
    <text x="660" y="725" class="attribute">field_name</text>
    <text x="660" y="740" class="attribute">old_value</text>
    <text x="660" y="755" class="attribute">new_value</text>
    <text x="660" y="770" class="attribute fk">changed_by (FK)</text>
    <text x="660" y="785" class="attribute">changed_at</text>
  </g>
  
  <!-- Relationships -->
  
  <!-- Users to Repair Requests (client_id) -->
  <path d="M 250 160 Q 350 160 450 400" class="relationship"/>
  <text x="320" y="250" class="cardinality">1</text>
  <text x="420" y="380" class="cardinality">M</text>
  <text x="300" y="270" class="attribute" font-size="9">client_id</text>
  
  <!-- Users to Repair Requests (master_id) -->
  <path d="M 250 180 Q 370 180 450 420" class="relationship"/>
  <text x="340" y="270" class="cardinality">1</text>
  <text x="420" y="400" class="cardinality">M</text>
  <text x="320" y="290" class="attribute" font-size="9">master_id</text>
  
  <!-- Equipment Types to Equipment Models -->
  <line x1="550" y1="140" x2="650" y2="140" class="relationship"/>
  <text x="570" y="135" class="cardinality">1</text>
  <text x="630" y="135" class="cardinality">M</text>
  
  <!-- Equipment Types to Repair Requests -->
  <path d="M 450 200 Q 450 250 500 300" class="relationship"/>
  <text x="440" y="220" class="cardinality">1</text>
  <text x="490" y="290" class="cardinality">M</text>
  
  <!-- Equipment Models to Repair Requests -->
  <path d="M 750 220 Q 750 260 650 300" class="relationship"/>
  <text x="740" y="240" class="cardinality">1</text>
  <text x="640" y="290" class="cardinality">M</text>
  
  <!-- Request Statuses to Repair Requests -->
  <path d="M 950 140 Q 800 140 700 300" class="relationship"/>
  <text x="920" y="135" class="cardinality">1</text>
  <text x="680" y="290" class="cardinality">M</text>
  
  <!-- Repair Requests to Request Comments -->
  <path d="M 450 500 Q 350 500 250 650" class="relationship"/>
  <text x="420" y="490" class="cardinality">1</text>
  <text x="270" y="640" class="cardinality">M</text>
  
  <!-- Repair Requests to Quality Ratings -->
  <line x1="500" y1="580" x2="500" y2="650" class="relationship"/>
  <text x="490" y="600" class="cardinality">1</text>
  <text x="490" y="640" class="cardinality">1</text>
  
  <!-- Repair Requests to Request History -->
  <path d="M 650 500 Q 700 500 700 650" class="relationship"/>
  <text x="670" y="490" class="cardinality">1</text>
  <text x="690" y="640" class="cardinality">M</text>
  
  <!-- Users to Request Comments -->
  <path d="M 150 240 Q 150 400 150 650" class="relationship"/>
  <text x="140" y="260" class="cardinality">1</text>
  <text x="140" y="640" class="cardinality">M</text>
  
  <!-- Users to Request History -->
  <path d="M 250 200 Q 500 200 750 650" class="relationship"/>
  <text x="270" y="195" class="cardinality">1</text>
  <text x="730" y="640" class="cardinality">M</text>
  
  <!-- Legend -->
  <g id="legend">
    <rect x="950" y="300" width="180" height="120" fill="#f5f5f5" stroke="#999" stroke-width="1"/>
    <text x="1040" y="320" text-anchor="middle" class="entity-title">Легенда</text>
    <text x="960" y="340" class="pk">PK - Первичный ключ</text>
    <text x="960" y="355" class="fk">FK - Внешний ключ</text>
    <text x="960" y="370" class="attribute">UK - Уникальный ключ</text>
    <text x="960" y="385" class="cardinality">1 - Один</text>
    <text x="960" y="400" class="cardinality">M - Много</text>
  </g>
  
</svg>